#!/bin/sh

OSES="linux darwin"

set -o errexit

. make/include/colors.sh
. make/include/versioning.sh

printf "%b==> Building %b\n" "${OK_COLOR}" "${ERROR_COLOR}"

for OS in ${OSES}; do
  if test "${OS}" = windows ; then SUFFIX=".exe" ; else SUFFIX="" ; fi
  env GOOS="${OS}" GOARCH=amd64 go build -o "build/${OS}-amd64/cf-plugin-backup${SUFFIX}" \
    -ldflags="-X main.version=${ARTIFACT_VERSION}" \
    ./
  cp README.txt LICENSE.* "build/${OS}-amd64/"
done

printf "%b" "${NO_COLOR}"
